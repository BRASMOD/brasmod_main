base_ids <- base_ids %>%
mutate(idhead2 = ifelse(base_ids$V2005 == "Pessoa responsável pelo domicílio",
yes = as.numeric(base_ids$idperson),
no = 0))
base_ids <- base_ids %>%
mutate(idhead = ifelse(base_ids$V2005 == "Pessoa responsável pelo domicílio",
yes = base_ids$idperson,
no = 0))
base_ids <- base_ids %>%
mutate(idhead = ifelse(base_ids$V2005 == "Pessoa responsável pelo domicílio",
yes = base_ids$idperson,
no = "0"))
y$idperson
#Create the variable idhead, being equal to idperson if the individual is the
#household head, and 0 if note; we then group by household and give the head's
#idperson as idhead to everyone. "VD2002" is the condition within household variable
base_ids <- y
base_ids <- base_ids %>%
mutate(idhead = ifelse(base_ids$V2005 == "Pessoa responsável pelo domicílio",
yes = base_ids$idperson,
no = "0"))
#Create the variable idhead, being equal to idperson if the individual is the
#household head, and 0 if note; we then group by household and give the head's
#idperson as idhead to everyone. "VD2002" is the condition within household variable
base_ids <- y
base_ids <- base_ids %>%
mutate(idhead = ifelse(base_ids$V2005 == "Pessoa responsável pelo domicílio",
yes = as.numeric(base_ids$idperson),
no = 0))
min(base_ids$idhead)
min(base_ids$idhead > 0)
min(base_ids$idhead != 0)
min(base_ids[idhead] != 0)
base_ids[idhead]
min(base_ids$idhead[base_ids$idhead > 0])
min(base_ids$idhead[idhead > 0])
min(base_ids$idhead[base_ids$idhead > 0])
base_ids <- base_ids %>%
mutate(idhead = ifelse(base_ids$V2005 == "Pessoa responsável pelo domicílio",
yes = as.numeric(base_ids$idperson),
no = 0)) %>%
group_by(idhh) %>%
mutate(idhead = as.character(min(base_ids$idhead[base_ids$idhead > 0]))) %>%
ungroup(idhh)
#Create the variable idhead, being equal to idperson if the individual is the
#household head, and 0 if note; we then group by household and give the head's
#idperson as idhead to everyone. "VD2002" is the condition within household variable
base_ids <- y
base_ids <- base_ids %>%
mutate(idhead = ifelse(base_ids$V2005 == "Pessoa responsável pelo domicílio",
yes = as.numeric(base_ids$idperson),
no = 999999999999999999)) %>%
group_by(idhh) %>%
mutate(idhead = as.character(min(idhead))) %>%
ungroup(idhh)
View(base_ids %>% select(idhh, idperson, idhead))
base_ids <- base_ids %>%
mutate(malehead = ifelse(V2007 == "Homem" &
V2005 == "Pessoa responsável pelo domicílio", #identifies male heads
yes = 1,
no = 0),
femalehead = ifelse(V2007 == "Mulher" &
V2005 == "Pessoa responsável pelo domicílio", #identifies female heads
yes = 1,
no = 0)) %>%
group_by(idhh) %>%
mutate(malehead = max(malehead), femalehead = max(femalehead))
print(unique(base_ids$V2005))
View(base_ids %>% select(idhh, idperson, malehead, femalehead, V2005) %>% filter())
View(base_ids %>% select(idhh, idperson, malehead, femalehead, V2005) %>%
filter(V2005 == "Pessoa responsável pelo domicílio"))
View(base_ids %>% select(idhh, idperson, idhead) %>% filter(v2005 == "Pessoa responsável pelo domicílio"))
View(base_ids %>% select(idhh, idperson, idhead, V2005) %>% filter(V2005 == "Pessoa responsável pelo domicílio"))
View(base_ids %>% select(idhh, idperson, idhead, V2005)
)
View(base_ids %>% select(idhh, idperson, idhead, V2005) %>% filter(V2005 == "Pessoa responsável pelo domicílio"))
View(base_ids %>% select(idhh, idperson, idhead, V2005) %>% filter(V2005 == "Pessoa responsável pelo domicílio") %>% group_by(idhh) summarise(n = count()))
View(base_ids %>% select(idhh, idperson, idhead, V2005) %>% filter(V2005 == "Pessoa responsável pelo domicílio") %>% group_by(idhh) %>%  summarise(n = count()))
View(base_ids %>% select(idhh, idperson, idhead, V2005) %>% filter(V2005 == "Pessoa responsável pelo domicílio") %>% group_by(idhh) %>%  summarise(n = count(idhh)))
View(base_ids %>% select(idhh, idperson, idhead, V2005) %>% filter(V2005 == "Pessoa responsável pelo domicílio") %>% group_by(idhh) %>%  summarise(n = n()))
base_ids <- base_ids %>%
mutate(idmalehead = ifelse(V2007 == "Homem" &
V2005 == "Pessoa responsável pelo domicílio",
yes = idperson,
no = 0),
idfemalehead = ifelse(V2007 == "Mulher" &
V2005 == "Pessoa responsável pelo domicílio",
yes = idperson,
no = 0))
base_ids <- base_ids %>%
mutate(idmalehead = ifelse(V2007 == "Homem" &
V2005 == "Pessoa responsável pelo domicílio",
yes = as.numeric(idperson),
no = 0),
idfemalehead = ifelse(V2007 == "Mulher" &
V2005 == "Pessoa responsável pelo domicílio",
yes = as.numeric(idperson),
no = 0))
base_ids <- base_ids %>%
mutate(idmalehead = ifelse(V2007 == "Homem" &
V2005 == "Pessoa responsável pelo domicílio",
yes = as.numeric(idperson),
no = 0),
idfemalehead = ifelse(V2007 == "Mulher" &
V2005 == "Pessoa responsável pelo domicílio",
yes = as.numeric(idperson),
no = 0)) %>%
group_by(idhh) %>%
mutate(idmalehead = as.character(max(idmalehead)),
idfemalehead = as.character(max(idfemalehead)))
class(base_ids$idhh)
View(base_ids %>% filter(idhh == 1387) %>% select(idhh, idmalehead, idfemalehead, malehead, femalehead)
)
y2 <- base_ids
base_ids <- base_ids %>%
mutate(idpartner = ifelse(V2005 == "Cônjuge ou companheiro(a) de sexo diferente " |
V2005 == "Cônjuge ou companheiro(a) do mesmo sexo", #if head's partner
yes = idhead,
no = "0"),
idfather = ifelse(
malehead == 1 &
(V2005 == "Filho(a) somente do responsável" |
V2005 == "Filho(a) do responsável e do cônjuge"), #if head's child and head is a man
yes = idmalehead,
no = "0"),
idmother = ifelse(
femalehead == 1 &
(V2005 == "Filho(a) somente do responsável" |
V2005 == "Filho(a) do responsável e do cônjuge"), #if head's child and head is a woman
yes = idmalehead,
no  = 0))
#Identify household members with respect to head
base_ids <- base_ids %>%
mutate(idpartner = ifelse(V2005 == "Cônjuge ou companheiro(a) de sexo diferente " |
V2005 == "Cônjuge ou companheiro(a) do mesmo sexo", #if head's partner
yes = idhead,
no = "0"),
idfather = ifelse(
malehead == 1 &
(V2005 == "Filho(a) somente do responsável" |
V2005 == "Filho(a) do responsável e do cônjuge"), #if head's child and head is a man
yes = idmalehead,
no = "0"),
idmother = ifelse(
femalehead == 1 &
(V2005 == "Filho(a) somente do responsável" |
V2005 == "Filho(a) do responsável e do cônjuge"), #if head's child and head is a woman
yes = idmalehead,
no  = "0"))
View(base_ids %>% select(idhh, idperson, idfather, idmother, idhead))
View(base_ids %>% filter(idhh == 1387) %>% select(idhh, idperson, idfather, idmother))
base_ids <- y2
base_ids <- base_ids %>%
mutate(idpartner = ifelse(V2005 == "Cônjuge ou companheiro(a) de sexo diferente " |
V2005 == "Cônjuge ou companheiro(a) do mesmo sexo", #if head's partner
yes = idhead,
no = "0"),
idfather = ifelse(
malehead == 1 &
(V2005 == "Filho(a) somente do responsável" |
V2005 == "Filho(a) do responsável e do cônjuge"), #if head's child and head is a man
yes = idmalehead,
no = "0"),
idmother = ifelse(
femalehead == 1 &
(V2005 == "Filho(a) somente do responsável" |
V2005 == "Filho(a) do responsável e do cônjuge"), #if head's child and head is a woman
yes = idfemalehead,
no  = "0"))
View(base_ids %>% filter(idhh == 1387) %>% select(idhh, idperson, idfather, idmother))
base_ids <- base_ids %>%
mutate(idpartnerofhead = ifelse(idpartner == idhead, #se a pessoa for partner do head
yes = idperson, #idpartnerofhead é o ID dela
no = "0")) %>%
group_by(idhh) %>% #agrupa por domicílio
mutate(idpartnerofhead = as.character(max(as.numeric(idpartnerofhead)))) %>% #agrega o idpartnerofhead
ungroup(idhh) %>% #desagrupa
mutate(idpartner = ifelse(idperson == idhead, #se a pessoa for head
yes = idpartnerofhead, #o idpartner dela é o idpartnerofhead
no = idpartner)) #se não, mantém
View(base_ids %>% select(idhh, idperson, idpartner, idhead, idpartnerofhead))
class(base_ids$idperson)
base_ids <- y2
#Make sure that the true head's idpartner be the ID of the individual whose partner
#is the head (it's ugly, but it works)
base_ids <- base_ids %>%
mutate(idpartnerofhead = ifelse(idpartner == idhead, #se a pessoa for partner do head
yes = idperson, #idpartnerofhead é o ID dela
no = "0"))
base_ids <- base_ids %>%
mutate(idpartner = ifelse(V2005 == "Cônjuge ou companheiro(a) de sexo diferente " |
V2005 == "Cônjuge ou companheiro(a) do mesmo sexo", #if head's partner
yes = idhead,
no = "0"),
idfather = ifelse(
malehead == 1 &
(V2005 == "Filho(a) somente do responsável" |
V2005 == "Filho(a) do responsável e do cônjuge"), #if head's child and head is a man
yes = idmalehead,
no = "0"),
idmother = ifelse(
femalehead == 1 &
(V2005 == "Filho(a) somente do responsável" |
V2005 == "Filho(a) do responsável e do cônjuge"), #if head's child and head is a woman
yes = idfemalehead,
no  = "0"))
y2 <- base_ids
base_ids <- base_ids %>%
mutate(idpartnerofhead = ifelse(idpartner == idhead, #se a pessoa for partner do head
yes = idperson, #idpartnerofhead é o ID dela
no = "0"))
View(base_ids %>% select(idhh, idperson, idpartner, idhead, idpartnerofhead))
base_ids <- y2
View(base_ids %>% select(idhh, idperson, idpartner, idhead))
print(unique(base_ids$V2005))
base_ids <- base_ids %>%
mutate(idpartner = ifelse(V2005 == "Cônjuge ou companheiro(a) de sexo diferente" |
V2005 == "Cônjuge ou companheiro(a) do mesmo sexo", #if head's partner
yes = idhead,
no = "0"),
idfather = ifelse(
malehead == 1 &
(V2005 == "Filho(a) somente do responsável" |
V2005 == "Filho(a) do responsável e do cônjuge"), #if head's child and head is a man
yes = idmalehead,
no = "0"),
idmother = ifelse(
femalehead == 1 &
(V2005 == "Filho(a) somente do responsável" |
V2005 == "Filho(a) do responsável e do cônjuge"), #if head's child and head is a woman
yes = idfemalehead,
no  = "0"))
View(base_ids %>% select(idhh, idperson, idpartner, idhead))
base_ids <- base_ids %>%
mutate(idpartnerofhead = ifelse(idpartner == idhead, #se a pessoa for partner do head
yes = idperson, #idpartnerofhead é o ID dela
no = "0"))
View(base_ids %>% select(idhh, idperson, idpartner, idhead, idpartnerofhead))
base_ids <- base_ids %>%
mutate(idpartnerofhead = ifelse(idpartner == idhead, #se a pessoa for partner do head
yes = idperson, #idpartnerofhead é o ID dela
no = "0")) %>%
group_by(idhh) %>% #agrupa por domicílio
mutate(idpartnerofhead = as.character(max(as.numeric(idpartnerofhead)))) %>% #agrega o idpartnerofhead
ungroup(idhh) %>% #desagrupa
mutate(idpartner = ifelse(idperson == idhead, #se a pessoa for head
yes = idpartnerofhead, #o idpartner dela é o idpartnerofhead
no = idpartner)) #se não, mantém
View(base_ids %>% select(idhh, idperson, idpartner, idhead, idpartnerofhead))
library(tidyverse)
library(readxl)
library(PNADcIBGE)
year = 2020
pnad_raw <- get_pnadc(year = year,
interview = 5)
library(dplyr)
library(data.table)
library(tidyverse)
values <- rep(1:3, each = 3)
# Repeat the vector until it reaches the desired length (150,000 lines)
repeated_values <- rep(values, length.out = 150000)
df <- data.frame(Column = repeated_values)
View(df)
num_repetitions <- ceiling(150000 / length(values))
# Repeat the vector to reach the desired length
repeated_values <- rep(values, times = num_repetitions)[1:150000]
df <- data.frame(Column = repeated_values)
View(df)
repeated_values
values <- rep(1:50000, each = 3)
print(values)
df <- data.frame(Column = values)
View(df)
income_tax_database <- data.frame(Column = idhh)
idhh <- rep(1:50000, each = 3)
income_tax_database <- data.frame(Column = idhh)
rm()
rm(list=ls())
income_tax_database <- data.frame(Column = idhh) %>%
group_by(idhh) %>%
(mutate(idperson = paste0(idhh, "0", row_number())))
idhh <- rep(1:50000, each = 3)
income_tax_database <- data.frame(Column = idhh)
View(income_tax_database)
idhh <- rep(1:50000, each = 3)
income_tax_database <- data.frame(idhh = idhh)
View(income_tax_database)
income_tax_database <- data.frame(idhh = idhh) %>%
group_by(idhh) %>%
(mutate(idperson = paste0(idhh, "0", row_number())))
income_tax_database <- data.frame(idhh = idhh) %>%
group_by(idhh) %>%
mutate(idperson = paste0(idhh, "0", row_number()))
View(income_tax_database)
income_tax_database <- data.frame(idhh = idhh) %>%
group_by(idhh) %>%
mutate(idperson = paste0(idhh, "0", row_number()),
idfather = ifelse(idperson = max(idperson),
yes = 0,
no = max(idperson)))
income_tax_database <- data.frame(idhh = idhh) %>%
group_by(idhh) %>%
mutate(idperson = paste0(idhh, "0", row_number()),
idfather = ifelse(idperson == max(idperson),
yes = 0,
no = max(idperson)))
View(income_tax_database)
income_tax_database <- data.frame(idhh = idhh) %>%
group_by(idhh) %>%
mutate(idperson = paste0(idhh, "0", row_number()),
idfather = ifelse(idperson == min(idperson),
yes = 0,
no = min(idperson)))
View(income_tax_database)
income_tax_database <- data.frame(idhh = idhh) %>%
group_by(idhh) %>%
mutate(idperson = paste0(idhh, "0", row_number()),
idfather = ifelse(idperson == min(idperson),
yes = 0,
no = min(idperson)),
idmother = 0,
idpartner = 0,
dct = 76)
View(income_tax_database)
dwt = 1/50000)
1/50000
as.numeric(1/50000)
dwt = 100/50000)
dct = 76)
no = min(idperson)))
no = min(idperson))
no = min(idperson))
no = min(idperson)))
income_tax_database <- data.frame(idhh = idhh) %>%
group_by(idhh) %>%
mutate(idperson = paste0(idhh, "0", row_number()),
idfather = ifelse(idperson == min(idperson),
yes = 0,
no = min(idperson)))
income_tax_database <- data.frame(idhh = idhh) %>%
group_by(idhh) %>%
mutate(idperson = paste0(idhh, "0", row_number()),
idfather = ifelse(idperson == min(idperson),
yes = 0,
no = min(idperson)),
idmother = 0,
idpartner = 0,
dct = 76,
dwt = 100/50000)
View(income_tax_database)
income_tax_database$dag <- rep_len(c(35, 11, 6), length.out = nrow(income_tax_database)/3)
income_tax_database$dag <- rep_len(c(35, 11, 6), length.out = nrow(income_tax_database))
View(income_tax_database)
income_tax_database$dec <- rep_len(c(0, 3, 2), length.out = nrow(income_tax_database))
income_tax_database$les <- rep_len(c(3, 6, 6), length.out = nrow(income_tax_database))
income_tax_database <- data.frame(idhh = idhh) %>%
group_by(idhh) %>%
mutate(idperson = paste0(idhh, "0", row_number()),
idfather = ifelse(idperson == min(idperson),
yes = 0,
no = min(idperson)),
idmother = 0,
idpartner = 0,
dct = 76,
dwt = 1) %>%
ungroup(idhh)
income_tax_database$dag <- rep_len(c(35, 12, 6), length.out = nrow(income_tax_database))
income_tax_database$dec <- rep_len(c(0, 3, 2), length.out = nrow(income_tax_database))
income_tax_database$les <- rep_len(c(3, 6, 6), length.out = nrow(income_tax_database))
income_tax_database$les <- rep_len(c(3, 6, 6), length.out = nrow(income_tax_database))
View(income_tax_database)
income_tax_database <- income_tax_database %>%
mutate(yem = ifelse(dag < 18,
yes = 0,
no = idhh))
View(income_tax_database)
income_tax_database$les <- rep_len(c(1, 2, 1), length.out = nrow(income_tax_database))
income_tax_database$dag <- rep_len(c(35, 12, 6), length.out = nrow(income_tax_database))
income_tax_database$dec <- rep_len(c(0, 3, 2), length.out = nrow(income_tax_database))
income_tax_database$les <- rep_len(c(3, 6, 6), length.out = nrow(income_tax_database))
income_tax_database <- income_tax_database %>%
mutate(yem = ifelse(dag < 18,
yes = 0,
no = idhh))
income_tax_database$dgn <- rep_len(c(1, 2, 1), length.out = nrow(income_tax_database))
income_tax_database$lhw <- rep_len(c(40, 0, 0), length.out = nrow(income_tax_database))
income_tax_database$loc <- rep_len(c(1, 0, 0), length.out = nrow(income_tax_database))
income_tax_database <- data.frame(idhh = idhh) %>%
group_by(idhh) %>%
mutate(idperson = paste0(idhh, "0", row_number()),
idfather = ifelse(idperson == min(idperson),
yes = 0,
no = min(idperson)),
idmother = 0,
idpartner = 0,
dct = 76,
dwt = 1) %>%
ungroup(idhh)
income_tax_database$dag <- rep_len(c(40, 12, 6), length.out = nrow(income_tax_database))
income_tax_database$dec <- rep_len(c(0, 3, 2), length.out = nrow(income_tax_database))
income_tax_database$les <- rep_len(c(3, 6, 6), length.out = nrow(income_tax_database))
income_tax_database <- income_tax_database %>%
mutate(yem = ifelse(dag < 18,
yes = 0,
no = idhh))
income_tax_database$dgn <- rep_len(c(1, 2, 1), length.out = nrow(income_tax_database))
income_tax_database$lhw <- rep_len(c(40, 0, 0), length.out = nrow(income_tax_database))
income_tax_database$dms <- rep_len(c(1, 1, 1), length.out = nrow(income_tax_database))
income_tax_database$loc <- rep_len(c(1, 0, 0), length.out = nrow(income_tax_database))
income_tax_database <- income_tax_database %>%
mutate(yse = 0,
yiy = 0,
ddi = 0,
poa = 0,
bdioa = 0,
ypt = 0)
income_tax_database <- income_tax_database %>%
mutate(yse = 0,
yiy = 0,
ddi = 0,
poa = 0,
bdioa = 0,
ypt = 0) %>%
group_by(idhh) %>%
mutate(yhh = sum(as.numeric(yse), #total household income
as.numeric(yem),
as.numeric(yiy)),
yhh00 = yhh/n())
ungroup(idhh)
income_tax_database <- income_tax_database %>%
mutate(yse = 0,
yiy = 0,
ddi = 0,
poa = 0,
bdioa = 0,
ypt = 0) %>%
group_by(idhh) %>%
mutate(yhh = sum(as.numeric(yse), #total household income
as.numeric(yem),
as.numeric(yiy)),
yhh00 = yhh/n()) %>%
ungroup(idhh)
View(income_tax_database)
income_tax_database <- income_tax_database %>%
mutate(yse = 0,
yiy = 0,
ddi = 0,
poa = 0,
bdioa = 0,
ypt = 0,
lpm = 0) %>%
group_by(idhh) %>%
mutate(yhh = sum(as.numeric(yse), #total household income
as.numeric(yem),
as.numeric(yiy)),
yhh00 = yhh/n()) %>%
ungroup(idhh)
library(tidyverse)
library(data.table)
idhh <- rep(1:50000, each = 3)
income_tax_database <- data.frame(idhh = idhh) %>%
group_by(idhh) %>%
mutate(idperson = paste0(idhh, "0", row_number()),
idfather = ifelse(idperson == min(idperson),
yes = 0,
no = min(idperson)),
idmother = 0,
idpartner = 0,
dct = 76,
dwt = 1) %>%
ungroup(idhh)
income_tax_database$dag <- rep_len(c(40, 12, 6), length.out = nrow(income_tax_database))
income_tax_database$dec <- rep_len(c(0, 3, 2), length.out = nrow(income_tax_database))
income_tax_database$les <- rep_len(c(3, 6, 6), length.out = nrow(income_tax_database))
income_tax_database <- income_tax_database %>%
mutate(les01 = les,
les02 = les,
les03 = les,
les04 = les)
income_tax_database <- income_tax_database %>%
mutate(yem = ifelse(dag < 18,
yes = 0,
no = idhh))
income_tax_database$dgn <- rep_len(c(1, 2, 1), length.out = nrow(income_tax_database))
income_tax_database$lhw <- rep_len(c(40, 0, 0), length.out = nrow(income_tax_database))
income_tax_database$dms <- rep_len(c(1, 1, 1), length.out = nrow(income_tax_database))
income_tax_database$loc <- rep_len(c(1, 0, 0), length.out = nrow(income_tax_database))
income_tax_database <- income_tax_database %>%
mutate(yse = 0,
yiy = 0,
ddi = 0,
poa = 0,
bdioa = 0,
ypt = 0,
lpm = 0) %>%
group_by(idhh) %>%
mutate(yhh = sum(as.numeric(yse),
as.numeric(yem),
as.numeric(yiy)),
yhh00 = yhh/n()) %>%
ungroup(idhh)
View(income_tax_database)
setwd("C:\\Users\\joao.perez\\Desktop\\Projetos\\PNAD")
library(data.table)
pnad2019 <- fread("pnad2019 euromod.txt")
View(pnad2019)
setwd("C:\\Users\\joao.perez\\Downloads\\brasmod\\brasmod\\Input")
pnad2019 <- fread("pnad2019 euromod.txt")
View(pnad2019)
setwd("C:\\Users\\joao.perez\\Downloads\\brasmod\\brasmod\\Input")
pnad2019 <- fread("pnad2019 euromod.txt")
View(pnad2019)
